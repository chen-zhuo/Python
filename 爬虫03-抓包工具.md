# 抓包工具

### 抓包简介

##### 背景知识

**数据在网络上是以很小的称为帧（Frame）的单位传输的，帧由几部分组成，不同的部分执行不同的功能。**

**帧通过特定的称为网络驱动程序的软件进行成型，然后通过网卡发送到网线上，通过网线到达它们的目的机器，在目的机器的一端执行相反的过程。接收端机器的以太网卡捕获到这些帧，并告诉操作系统帧已到达，然后对其进行存储。**

在一般情况下，网络上所有的机器都可以“听”到通过的流量，但对不属于自己的数据则不予响应（换句话说，工作站A不会捕获属于工作站B的数据，而是简单地忽略这些数据）。

##### 网络数据包

**包(Packet)是TCP/IP协议通信传输中的数据单位，一般也称“数据包”。**

**TCP/IP协议是工作在OSI模型第三层(网络层)、第四层(传输层)上的，帧工作在第二层(数据链路层)。**上一层的内容由下一层的内容来传输，**所以在局域网中，“包”是包含在“帧”里的**。

在网络里，单个消息被划分为多个包，包主要由“目的IP地址”、“源IP地址”、“净载数据”等部分构成：

**目的IP地址**：相当于收信人地址，说明这个数据包是要发给谁的。

**源IP地址**：相当于发信人地址，是说明这个数据包是发自哪里的。

**净载数据**：相当于信件的内容。 

正是因为数据包具有这样的结构，安装了TCP/IP协议的计算机之间才能相互通信。**我们在使用基于TCP/IP协议的网络时，网络中其实传递的就是数据包。**

##### 抓包

抓包（packet capture）：**将网络传输发送与接收的数据包进行截获、重发、编辑、转存等操作，用来检查网络安全，也常被用来进行数据截取等。**

通过对网络上传输的数据包进行抓取，并对其进行分析，可以做到：

1. 获取网络通讯的真实内容（甚至可以获取用户名和密码）
2. 对网络故障分析
3. 对程序网络接口分析

### 常用抓包工具

目前，网络上有许许多多的抓包工具，因为该工具的主要功能就是抓包，也就不存在工具的好与坏，不同的工具可能附带有不同的功能，最后抓出来的数据包内容都是一样的。**对于爬虫开发者来说，熟练的使用任意两种抓包工具，就完全能满足需求了。**

##### 开发者工具

现在许多常用的浏览器（Chrome、Firefox、IE）里面都有内置的开发者工具，其中的就有抓包的功能。

谷歌浏览器内置的开发者工具：Chrome Developer Tools

打开方式：按 **`F12` 键** 或者 **点击右上角“菜单”选项选择“更多工具”从中选择“开发者工具”**。

![QQ截图20200830231904](image/QQ截图20200830231904.png)

Network栏：**展示加载网页所请求的资源信息。**

```
红色框内，从上到下，从左到右分别是：
第一个框(抓包功能)：开启/关闭抓包、清空全部资源信息、过滤功能、查找功能
第二个框(资源分类)：ALL(全部类型)、XHR(动态加载)、JS(js资源)、CSS(css样式)、Img(图片)、Media(媒体)、Font(字体)、Doc(文档)、WS(通信)、Manifest(缓存)、Other(其他)
第三个框(加载时间)：从请求第一个资源到网页加载完成的时间线
第四个框(资源展示)：Name(资源名称)、Status(状态码)、Type(类型)、Initiator(发起)、Size(大小)、Time(耗时)、Waterfall(瀑布流)
第五个框(资源列表)：详细的展示了每个资源的名称等属性。
```

**选中任意一个资源，在右侧边栏就会出现该资源的详细信息，通过这些信息我们可以针对需要获取的资源进行具体分析。**

![QQ截图20200901234920](image/QQ截图20200901234920.png)

当在列表中选中一个资源时，对应上面瀑布流中的该资源加载的时间条也会被选中。

```
在右侧边栏中六个选项卡，可以帮助我们查看该资源从请求到加载完成的所有信息：

```