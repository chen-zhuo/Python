# 类和对象

### 类的声明

##### 关键字class

class：**声明类的关键字。**

##### 格式

```
class 类名（父类）：
    属性
    方法
```

类名：**类的名称**，标识符，**首字母大写**，驼峰式命名

（父类）：里面**写要继承的类**（即父类的名字），**不继承可以省略**

属性：**对象属性和类的字段** --- 保存数据

方法：实质就是**声明在类中的函数** --- 实现功能

### 对象声明

##### 创建对象

```
对象名 = 类名()  
```

**注意：创建对象的时候，类名后面的（）不能少。**

**注意：一个类可以创建无数个对象。**

##### 使用对象

```
对象.方法名()
对象.属性名
```

**注意：使用对象可以通过点语法使用类中声明的对象的方法和属性。**

### 默认参数self

##### 举例说明

```
class Person:

    def my_self(self):
        print('打印self: ', self)

    def sleep(self):
        print('在睡觉，晚安！')


# 创建对象p1
p1 = Person()
print('打印对象：', p1)

# 使用对象方法my_self 
p1.my_self()
# 使用对象方法sleep
p1.sleep()

输出：
打印对象： <__main__.Person object at 0x000000F5BD6E3400>
打印self： <__main__.Person object at 0x000000F5BD6E3400>
在睡觉，晚安！
```

##### 参数self作用

1. 上面对象方法都会带有一个默认参数self，**这个参数不用传参**（系统会自动给self传参）。
2. **谁来调用这个方法，self就是谁。**通过上面打印**对象p1和self结果一样，打比方self就是镜子，对象是p1，那么self里面就是p1**。

### 对象属性

**对象不止有上面睡觉的行为，还有姓名、年龄等属性。**

##### 举例说明

```
class Person:

	# 在init方法中声明对象属性
	# name、age就是Person这个类的对象属性
	# 小花、20就是Person这个类的对象属性初始值
    def __init__(self, name, age=20):
    	# 将值（初始值或参数）对属性进行赋值
        self.name = name
        self.age = age

# 没有赋值的属性，默认使用初始值
p1 = Person(name='小花')
# 通过对象.属性使用对象属性
print(p1.name, p1.age)		# 小花 20

# 构造方法中的参数，实质是传给init方法的参数
p2 = Person('张三', 18)
print(p2.name,p2.age)		# 陈酌 18
```

##### \__init__方法

1. \__init__方法是系统自带的一个**声明对象属性的方法，作用是对对象的属性进行初始化**。
2. \__init__方法中的对象属性有两种情况：**有初始值**、**没有初始值**
   1. 属性位置：**有初始值的，必须放在没有初始值的后面。**(self, name, age=20)
   2. 接收参数：**有初始值的，参数会覆盖掉初始值；没有初始值的，接收参数值。**
3. **\__init__方法不能直接调用，创建对象的时候系统会自动调用这个方法**，调用时候，**除了self以外，一定要保证其他的每个属性都必须有值**
   1. **没有参数**，**属性会默认使用\__init__中的初始值**。（上面的例子中 ’20‘）
   2. **有参数、没有属性对应**，将**参数按位置传递给\__init__中的属性**使用。（上面的例子中 ’张三，18‘ ）
   3. **有参数、有属性对应**(上面的例子中 ’name='小花'‘ )，**属性就使用对应的参数值**。
   4. **属性没有初始值，外部也没有传递参数**，**会报错**，因为**每个属性都必须有值**。

### 增删改查

**对象的属性是可以进行增删改查的操作**

```
class Dog:

    def __init__(self, age=0, color='yellow'):
        self.age = age
        self.color = color

# 创建一个dog1对象
# 参数age=3,color='white'
dog1 = Dog(3, 'white')
```

##### 查属性

方法一：对象.属性（如果属性不存在，会报错）

方法二：对象.\__getattribute__(属性名)

方法三：getattr（对象，属性名，默认值），**当属性不存在时不会报错，并且返回默认值**

```
print(dog1.age)							# 3
print(dog1.__getattribute__('age'))		# 3
print(getattr(dog1, 'abc', '无名氏'))	  # 无名氏（不存在'abc'属性）
```

##### 改属性

方法一：对象.属性=新值（通过给对象属性赋值来修改）

方法二：对象.\__setattr__(属性名，新值)

方法三：setattr（对象，属性名，默认值），**当属性不存在时不会报错，还会给这个对象添加了一个新属性**

```
dog1.age = 4
print(dog1.age)							# 4

dog1.__setattr__('color', 'black')
print(dog1.color)						# black

setattr(dog1, 'color', 'blue')
print(dog1.color)						# blue
```

##### 增属性

方法一：对象.属性 = 值（**这个属性不存在**）

方法二：对象.\__setattr__(属性名，新值)

方法三：setattr（对象，属性名，默认值），**属性不存在，给对象添加了一个新属性**

**注意：属性是添加给对象的，而不是类的。**

```
dog1.name = '大黄'
print(dog1.name)						# 大黄

dog1.__setattr__('type', '哈士奇')
print(dog1.type)						# 哈士奇

setattr(dog1, 'sex', '公')
print(dog1.sex)							# 公

dog2 = Dog()
print(dog2.name)						# 报错，新对象dog2没有name属性
```

##### 删属性

方法一：del 对象.属性

方法二：对象.\__delattr__(属性名，新值)

方法三：delattr（对象，属性名），**属性不存在，会报错**

**注意：删除属性是删除具体某个对象的属性，不会影响这个类的其他对象。**

```
del dog1.age
print(dog1.age)							# 报错，age属性不存在

dog1.__delattr__('color')
print(dog1.color)						# 报错，color属性不存在
```

### 属性约束

对象可以通过**对象.新属性 = 值**，增加新的属性。为了**统一对象的属性，禁止其他属性的出现**，就需要**属性约束**。

**注意：属性约束是建立在类上面的，只要通过这个类建立的对象，就必须要服从约束。**

##### 举例说明

```
class Person:
    # __slots__的功能：就是约束类中的对象的属性
    __slots__ = ('name', 'age', 'sex')		# __slots__有sex属性，没有tel属性

    def __init__(self, name='', age=0, tel=123):	
        self.name = name
        self.age = age
      # self.tel = tel  	 # 属性赋值的时候，tel属性没在__slots__中，就无法新增该属性

p1 = Person('小王', 20)
print(p1.age)				# 20

# 对象新增sex属性，因为sex属性存在于__slots__中，可以新增
p1.sex = '男'				
print(p1.sex)				# 男

# 因high属性没在__slots__里，无法新增该属性
# p1.high = 175
# print(p1.tel)				# 报错，属性不存在（因为上面无法新增该属性）
```

##### \__slots__功能

\__slots__的功能：就是将类中**对象的属性约束在一个元祖内**，被约束的对象**拥有的属性只能是元祖当中的，除元祖外的任何属性都不能拥有**。

### 可调对象

##### 举例说明

例1

```
class TestCall(object):
    def __init__(self, name):
        self.name = name
 
    def __call__(self, *args, **kwargs):
        print("self.name: %s. " % self.name, end='   ')
        print('__call__()  is  running ')
 
if __name__ == '__main__':
    call = TestCall(name='xiaoming')
    call.__call__()		# self.name: xiaoming.    __call__()  is  running 
   
    call()  			# self.name: xiaoming.    __call__()  is  running 
```

例2

```
class Fib(object):

    def __call__(self, num, *args, **kwargs):
        n, m, lst = 0, 1, []
        for i in range(num):
            lst.append(n)
            n, m = m, n + m
        return lst

f = Fib()
print(f(10))	                # [0, 1, 1, 2, 3, 5, 8, 13, 21, 34]
print(f.__call__(10))		# [0, 1, 1, 2, 3, 5, 8, 13, 21, 34]
```

##### \__call__方法

​	定义类的时候，实现\__call\_\_函数，可以把这个类型的对象当作函数来使用，`对象名() `等价于 `对象名.__call__()` ，让对象变成可调用的对象。

### 打印对象

通过**直接打印对象**，得到**更直观的对象信息**

##### 举例说明

例子1

```
class Person:

    def __init__(self, name='', age=0):
        self.name = name
        self.age = age

p1 = Person('小王', 20)
print(p1)	# <__main__.Person object at 0x000000FB3CF174A8>（不直观）
```

例子2

```
class Person:

    def __init__(self, name='', age=0):
        self.name = name
        self.age = age

	# 执行打印操作时，就会触发__str__方法
    def __str__(self):
        return self.name+','+str(self.age)


p1 = Person('小王', 20)
print(p1)	# 小王,20（直观）
```

##### \__str__方法

\__str__方法：是一个**执行对象打印操作就会触发的方法。内容为return语句，打印的就是return后面的返回值**。

