# 正则表达式

### 认识正则表达式

##### 定义

正则表达式：**对字符串进行查找、匹配、切割、替换用的一种工具**

**注意：正则表达式本身也是一个符合正则规范的字符串，前面一般要加r来阻止转义。**

##### re模块

python内置的**re模块**，包含字符串匹配、查找、切割等相关的方法。

```
# 通过导入re模块进行使用
import re
```

##### 正则表达式符号

```
 .：匹配一个任意的字符
\w：匹配一个字符是字母、数字或者下划线
\W：匹配非字母、数字、下划线
\s：匹配一个空白字符（空格，换行，制表符）
\S：匹配非空白字符
\d：匹配一个数字字符
\D：匹配非数字字符
\b：检测边界（边界可以是空格、逗号、问号，但数字、字母不行）
\B：检测非边界
注意：正则表达式符号中有很多用到'\'的符号，其功能不是转义，而是表示特殊的意义。
 ^：检测字符串开始（^The --> 匹配以The开头的字符串）
 $：检测字符串结束
[]：匹配[]中出现的任意一个字符
	[0-9]：匹配0，1，2，3，4，5，6，7，8，9中的任意一个字符
	[a-z]：匹配任意一个小写字母
	[A-Z]：匹配任意一个大写字母
	[a-zA-Z]：匹配所有的字母
[^]：匹配不在[]出现的任意一个字符
注意：- [] ^ \在[]中是特殊的符号，需要加'\'；而 .{} () * + ? $ | 在[]中可以不用加'\'，来表示字符

匹配模式：贪婪模式（默认）、非贪婪模式
贪婪模式：匹配尽可能长的字符串（*、+、?、{N,}、{M,N}）
 	*：匹配0次或者多次
 	+：匹配一次或者多次
 	?：匹配0次或者1次
	{N}：匹配N次
		{N,}：匹配大于等于N次
		{M,N}：匹配至少M次最多N次
非贪婪模式：第一次匹配成功后就停止匹配（{m,n}?、{m,}?、??、*?、+?）
	*?：重复任意次，尽可能少的重复
	+?：重复一次或多次，尽可能少的重复
	??：重复0次或者1次，尽可能的少重复
	{N,}?：重复至少N次，尽可能少的重复
	{N,M}?：重复N到M次，尽可能少的重复

 |：分之（结果可以是‘|’左边或右边的正则表达式匹配的结果）
()：整合（匹配的时候让‘()’中的正则条件变成一个整体）
\N：匹配前面第N个组中匹配到的内容

注意：在正则表达式中单纯表达 . \ [] {} () * + ? | $ ^  这些有特殊意义字符，需要在前面加'\'
```

### fllmatch方法

##### 作用和格式

通过正则表达式和字符串进行**完全匹配**（**匹配成功，显示匹配的字符；匹配不成功，显示None**）

应用：判断一个字符串是否是某种字符串（判断账号、密码是否符合要求等）

格式：`re.fllmatch(正则表达式，字符串)`

##### 举例说明

```
# 1.  .：匹配一个任意的字符
# 匹配一个任意的字符
print(re.fullmatch('.', 'a'))     		# <... span=(0, 1), match='a'>
print(re.fullmatch('.', 'ab'))    		# None
# 匹配两个任意字符的字符串
print(re.fullmatch('..', 'ab'))   		# <... span=(0, 2), match='ab'>
# 匹配第一个字符是a，第二个字符是b的字符串
print(re.fullmatch('ab', 'ab'))   		# <... span=(0, 2), match='ab'>
# 匹配第一个字符是a,第二个字符是任意字符的字符串
print(re.fullmatch(r'a.', 'ab'))  		# <... span=(0, 2), match='ab'>

# 2. \w：匹配一个字符是字母、数字或者下划线
print(re.fullmatch(r'\w', '@'))  		# None
print(re.fullmatch(r'\w', 'a'))  		# <... span=(0, 1), match='a'>
print(re.fullmatch(r'\w', 'ab'))  		# None
# 匹配两个字符都是字母、数字或下划线的字符串
print(re.fullmatch(r'\w\w', 'ab'))  	# <... span=(0, 2), match='ab'>
print(re.fullmatch(r'\w.\w', 'u(9'))  	# <... span=(0, 3), match='u(9'>

# 3. \W：匹配非字母、数字、下划线
# 匹配第一个字符是非字母、数字、下划线的字符，第二个字符是字母、数字、下划线的字符串
print(re.fullmatch(r'\W\w', '&k'))  	# <... span=(0, 2), match='&k'>

# 4. \s：匹配一个空白字符（空格，换行，制表符）
# 匹配第一个字符是a，第二个字符是空白，最后一个字符是b的字符串
print(re.fullmatch('a\sb', 'a b'))  	# <... span=(0, 3), match='a b'>
print(re.fullmatch('a\sb', 'a\tb'))  	# <... span=(0, 3), match='a\tb'>
print(re.fullmatch('a\sb', 'a\nb'))  	# <... span=(0, 3), match='a\nb'>

# 5. \S：匹配非空白字符
print(re.fullmatch(r'\S.', 'p8'))  	 	# <... span=(0, 2), match='p8'>

# 6. \d：匹配一个数字字符
print(re.fullmatch(r'\d\d\d', '123'))  	# <... span=(0, 3), match='123'>
print(re.fullmatch(r'\d\d\d', '1b3')) 	# None
# 匹配第一个字符是0，后面两个字符是数字的字符串
print(re.fullmatch(r'0\d\d', '019'))  	# <... span=(0, 3), match='019'>

# 7. \D：匹配非数字字符
# 匹配第一个字符是非数字字符，第二个字符是字母、数字、下划线
print(re.fullmatch(r'\D\w', 'ab'))		# <... span=(0, 2), match='ab'>

# 8. \b：检测边界
# 三个任意字符的前面和后面都是边界的字符串
print(re.match(r'\b...\b', 'jsh'))  	# <... span=(0, 3), match='jsh'>
print(re.match(r'\b...\b', 'jsh   '))   # <... span=(0, 3), match='jsh'>
print(re.match(r'\b...\b', 'jsh,,,abc'))# <... span=(0, 3), match='jsh'>
print(re.match(r'\b...\b', 'jshb'))  	# None

# 9. \B：检测非边界
# 匹配前面两个字符是a和b,第三个字符是c。并且检测b的后面是一个非边界
print(re.fullmatch(r'ab\Bc', 'abc'))  	# <... span=(0, 3), match='abc'>
print(re.match(r'ab\Bc', 'abc0'))  		# <... span=(0, 3), match='abc'>

# 10. ^：检测字符串开始
# ^The --> 匹配以The开头的字符串
print(re.fullmatch(r'^The', 'The'))  	# <... span=(0, 3), match='The'>

# 11. $：检测字符串结束
print(re.findall(r'abc$', 'hah abc'))   # ['abc']
print(re.findall(r'abc$', 'hah abc-'))  # []
print(re.findall(r'abc$', 'hah abc   '))# []

# 12. []：匹配[]中出现的任意'一个字符'
# 匹配一个字符串，前三位是abc，第四位是字符1或者字符a
print(re.fullmatch(r'abc[1a]', 'abca')) # <... span=(0, 4), match='abca'>
print(re.fullmatch(r'abc[1a]', 'abc1')) # <... span=(0, 4), match='abc1'>
print(re.fullmatch(r'abc[1a]', 'abc1a'))# None
# 第一位是数字或者下划线，后面是abc
print(re.fullmatch(r'[\d_]abc', '1abc'))# <... span=(0, 4), match='1abc'>
print(re.fullmatch(r'[\d_]abc', '_abc'))# <... span=(0, 4), match='_abc'>
print(re.fullmatch(r'[\d_]abc', 'aabc'))# None

# 13. [^]：匹配不在[]出现的任意一个字符
# 匹配一个字符串，前三位是abc，第四位不是数字字符也不是字符a
print(re.fullmatch(r'abc[^\da]', 'abc1'))# None
print(re.fullmatch(r'abc[^\da]', 'abca'))# None
print(re.fullmatch(r'abc[^\da]', 'abcw'))# <... span=(0, 4), match='abcw'>

# 14. *：匹配0次或者多次
# 匹配一个字符串，前面是0个或者多个数字字符，然后是abc
print(re.fullmatch(r'\d*abc', 'abc'))  	 # <... span=(0, 3), match='abc'>
print(re.fullmatch(r'\d*abc', '1abc'))   # <... span=(0, 4), match='1abc'>
print(re.fullmatch(r'\d*abc', '321abc')) # <... span=(0, 6), match='321abc'>
print(re.fullmatch(r'\d*abc', '12a34abc'))# None

# 15. +：匹配一次或者多次
# 匹配一个字符串开头出现一次或者多个数字字符，然后再有0次或者多次数字、字母、下划线
print(re.fullmatch(r'\d+\w*', '12as'))	 # <... span=(0, 4), match='12as'>

# 16. ?：匹配0次或者1次
print(re.fullmatch(r'[a-z]?123', 'A123'))# <... span=(0, 4), match='c123'>
# 判断一个字符串是否是正整数字符串(除0开头)
print(re.fullmatch(r'[+]?[1-9][0-9]*', '+120'))# <... span=(0, 4), match='+120'>

# 17. {N}：匹配N次
# 前面3位是12ab中任意数字，然后是abc
print(re.fullmatch(r'[12ab]{3}abc', 'aaaabc'))  # <... span=(0, 6), match='aaaabc'>
print(re.fullmatch(r'[12ab]{3}abc', '21babc'))  # <... span=(0, 6), match='21babc'>

# 18. {N,}：匹配大于等于N次

# 19. {M,N}：匹配至少M次最多N次

# 20. *?：重复任意次，尽可能少的重复

# 21. +?：重复一次或多次，尽可能少的重复

# 22. ??：重复0次或者1次，尽可能的少重复

# 23. {N,}?：重复至少N次，尽可能少的重复

# 24. {N,M}?：重复N到M次，尽可能少的重复

# 25. |：分之
# 匹配一个字符串，是三个数字字符或者是三个小写字符
print(re.fullmatch(r'\d{3}|[a-z]{3}', 'wba'))   # <... span=(0, 3), match='wba'>

# 26. ()：整合
# 匹配一个字符串，abc整体重复三次
print(re.fullmatch(r'(abc){3}', ('abcabcabc'))) # <... span=(0, 9), match='abcabcabc'>
print(re.fullmatch(r'(\d\w[0-3]){2}', ('3a3')))  # None
print(re.fullmatch(r'(\d\w[0-3]){2}', ('3a37b1')))# <... span=(0, 6), match='3a37b1'>

# 27. \N：匹配前面第N个组中匹配到的内容
print(re.fullmatch(r'([1-9][a-z]{2})\1', '8hh8hh'))# <... span=(0, 6), match='8hh8hh'>

# 28. 在正则表达式中单纯表达 . \ [] {} () * + ? | $ ^  这些有特殊意义字符，需要在前面加'\'
re_str = 
print(re.fullmatch(r'\d+\.\d', '1299'))  		# None
print(re.fullmatch(r'\d+\.\d', '12.9'))  		# <... span=(0, 4), match='12.9'>
```

### 对象方法

```
match = re.fullmatch('\w{3}', 'hks')
print(match)  						# <...span=(0, 3), match='hks'>
# a.获取匹配到的结果
print(match.group())  				# hks
# b.获取匹配到范围
print(match.span())  				# (0, 3)
# c.获取匹配到的开始下标和结束下标
print(match.start(), match.end())  	# 0 3
# d.获取被匹配的原字符串
print(match.string)  				# hks
```

### match方法

##### 作用和格式

通过正则表达式和字符串进行**部分匹配**（**匹配成功，显示匹配的字符；匹配不成功，显示None**）

应用：判断一个字符串是否以某种字符串开头

格式：`re.match(正则表达式，字符串)`

##### 举例说明

```
print(re.match(r'0\d\d', '01'))      # None
print(re.match(r'0\d\d', '0190'))    # <... span=(0, 3), match='019'>
print(re.match(r'ba+?','baaaa'))     # <... span=(0, 2), match='ba'>
print(re.match(r'ba*?b','baaaaab'))  # <... span=(0, 7), match='baaaaab'>
```

### findall方法

##### 作用和格式

通过正则表达式获取字符串中满足正则条件的**所有的子串**（**查找成功，以列表形式返回查找到的字符串；查找不成功，显示[ ]**）

应用：字符串提取

**注意：使用findall获取子串，可以在正则表达式中添加括号，来约束获取的内容，findall r'a(b)' 是返回()里面的b的值，不是a的值，但匹配的时候还是按原正则表达式去查找；findall r'ab' 则是返回ab的值**

格式：`re.findall(正则表达式，字符串)`

##### 举例说明

```
# 找到The
print(re.findall(r'The', 'abc hThekl'))  # ['The']
# 找到以The开头的
print(re.findall(r'^The', 'abc hThekl'))  # []
print(re.findall(r'^The', 'The abc hThekl'))  # ['The']
print(re.findall(r'[a-zA-Z](\d+)', '12a123buy=236ok98s'))  # ['123', '98']
```

### finditer方法

##### 作用和格式

finditer用法的findall一样，只是**返回值的类型不一样**（**返回一个迭代器，迭代器中的内容是匹配对象**）

**注意：（）语法捕获部分无效**

格式：`re.finditer(正则表达式，字符串)`

##### 举例说明

```
result = re.finditer(r'[a-zA-Z](\d+)', '12a123buy=236ok98s')
for match in result:
    print(match)
    # <... span=(2, 6), match='a123'>
    # <... span=(14, 17), match='k98'>
```

### search方法

##### 作用和格式

通过正则表达式**在字符串中查找某种字符串，如果有多个满足条件的，只匹配第一个（返回值是匹配对象，如果找不到要求的返回None）**

应用：判断一个字符串中是否包含某种字符串

格式：`re.search(正则表达式，字符串)`

##### 举例说明

```
print(re.search(r'\d{2,}[a-z]', 'sha23n--877m0899'))  # <... span=(3, 6), match='23n'>
```

### split方法

##### 作用和格式

按正则表达式**匹配到的字符串**进行**切割**（返回值是列表，列表元素就切割后被分段的字符串）

格式：`re.split(正则表达式，字符串)`

##### 举例说明

```
print(re.split(r'\d+', 'ahsj27jk1kaj8js00'))  # ['ahsj', 'jk', 'kaj', 'js']
```

### sub方法

##### 作用和格式

在原字符串中查找符合正则的子串，**替换成新的字符串**（返回值是替换后的字符串）

格式：`sub(要替换的字符串，替换后的字符串，原字符串变量名（或原字符串）) `

```
# 将指定字符串中所有'sb'、'傻'、'叉'替换成 *
str1 = '你好sb,你全家都是sb，大，傻，叉!'

result = re.sub(r'sb|傻|叉', '*', str1)
print(result)  # 你好*,你全家都是*，大，*，*!
```
