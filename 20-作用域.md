# 作用域

### 定义

##### 作用域

作用域：变量可以**被使用的范围**

##### 全局变量

全局变量：**从声明开始，到文件结束都可以使用的变量**

**注意：for、if、while、try等语句不会产生新的作用域，也就不影响变量的作用域**

```
a = 10  	        # a是全局变量
print('=====',a)

for x in range(1):
    b = 100  		# b是全局变量
    print(b)
    print(a)

print('=====', b)

输出：
===== 10
100
10
===== 100
```

##### 局部变量

局部变量：**在函数（类）中声明的变量**（作用域是从**声明开始到函数结束**）

**注意：def、class、lambda等语句会产生新的作用域，会影响变量作用域**

```
def func3():
    aaa = 10    # aaa在函数内声明，为局部变量，作用域是函数内部
    print(aaa)

func3()         # 10

print(aaa)      # 报错,aaa没定义
```

##### 作用域细则

变量名引用会分作用域进行查找：**首先是本地，然后是函数内（如果有的话），之后是全局，最后是内置**。

### 更改作用域

##### 关键字global

格式：**global  变量**

作用：**在函数（类）中声明一个全局变量**

```
def func3():
    global aaa  # 声明aaa为全局变量
    aaa = 10
    print(aaa)

func3()         # 10

print(aaa)      # 10
```

对于一个全局变量，你的函数里如果只使用到了它的值，而**没有对其赋值**（`变量 = XXX`）的话，就**不需要声明global**。相反，如果**对其赋了值**的话，那么你就**需要声明`global`**。声明`global`的话，就表示你是在**对一个全局变量进行赋值**，而不是在向一个局部变量赋值。

简单说，在一个作用域里面给一个**变量赋值的时候，自动认为这个变量是这个作用域的本地变量，并屏蔽作用域外的同名的变量**。

```
names = ['唱歌']

def func():
	# names.append只是使用了names,append不属于赋值，不用声明global
    names.append('跳舞')
    print(names)			
    
func()						# ['唱歌', '跳舞']
				

def func1():
	# 这里对name进行了赋值，自动name是func1的本地变量，并屏蔽作用域外的同名变量
    names += ['跳舞']		                # 报错，本地没有定义names变量

func1()


def func2():
    global names
    names += ['跳舞']
    print(names)		

func2()						# ['唱歌', '跳舞', '跳舞']

# 注释：因为列表是可变对象，里面的值改变都是在一个列表内进行的。
```

当参数在方法中被改变，**若把这个改变给积累下来，而不是每一次都是从头开始变化的话，那么这个参数就需要声明为全局变量**。

```
counter = 1
def st():
    global counter
    for i in (1, 2, 3):
        counter += 1

st()          # 首先要运行函数，才能改变函数内对全局变量的改变
print(counter)

输出：
4
```

##### 关键字nonlocal

格式：**nonlocal  变量**

作用：在**内层函数中声明**为**最外层函数的局部变量**

```
def func11():
    a_11 = 10
    print('外部函数', a_11)	  # 2.外部函数 10

    def func12():
        nonlocal a_11 	          # 4.声明a_ll为最外层函数（func11()）的局部变量
        a_11 = 100
        print('内部函数', a_11)	  # 5.内部函数 100

    func12()                      # 3.执行内部函数func12()
    print('外部函数', a_11)	  # 6.外部函数 100

func11()	 		  # 1.调用外部函数func11()

print(a_11)  			  # 7.a_ll是个局部变量，在外部不能打印。
```
